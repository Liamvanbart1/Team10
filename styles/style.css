* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  --item-width: 12rem;
  --item-height: calc(var(--item-width) * 0.8);
  --bgColor: calc(360 / sibling-count() * sibling-index());
  --z-index1: 3;
  --z-index2: 4;
  --z-index3: 2;
  --z-index4: 1;
}

body {
  height: 200dvh;
  overflow-x: clip;
  timeline-scope: --horizontal-scroll;

  &::-webkit-scrollbar {
    display: none;
  }
}

main {
  position: fixed;
  top: 0;
  left: 0;

  perspective: 800px;

  width: 100dvw;
  height: 100dvh;
  display: flex;
  flex-direction: column;
  gap: 1rem;
  align-items: center;
  justify-content: center;
}

main * {
  transform-style: preserve-3d;
}

.vertical-scroll {
  display: grid;
  transform-style: preserve-3d;
  animation: --grow-progress linear forwards, --moveup linear forwards;
  animation-timeline: scroll();
  animation-range-start: 0dvh, 20dvh;
  animation-range-end: 20dvh, 60dvh;
}

ul {
  justify-content: center;
  align-items: center;
  display: grid;
  list-style: none;
  grid-row: 1;
  grid-column: 1;

  transform-style: preserve-3d;
  /* box-shadow: 1px 1px 5px #C4AB73; */


}

.fake-scroller {
  grid-row: 1;
  grid-column: 1;
  z-index: 10;
  position: relative;
  overflow: scroll;
  max-width: 100vw;
  height: 100%;
  scroll-timeline-axis: inline;

  .inner {
    width: 200vw;
    height: 100%;
  }

  &::-webkit-scrollbar {
    display: none;
  }

}

.horizontal-scroll {
  animation-range: cover 0 cover 100%;
  animation-name: rotate;

}

main li {
  grid-area: 1/1;
  width: var(--item-width);
  height: var(--item-height);
  background-color: red;
  border: 5px solid black;
  transform-style: preserve-3d;

  --item-angle: calc(360deg / sibling-count() * sibling-index());

  transform:
    rotateY(var(--item-angle)) translateZ(calc(2 * var(--item-width)))
}


@keyframes --grow-progress {
  0% {

    transform: translateZ(-50em) translateY(0);
    --z-index1: 3;
    --z-index2: 4;
    --z-index3: 2;
    --z-index4: 1;
  }

  100% {
    --z-index1: 4;
    --z-index2: 3;
    --z-index3: 2;
    --z-index4: 1;
    transform: translateZ(0em) translateY(35vh);
  }
}

@keyframes --shrink-progress {
  from {
    transform: translateZ(0em) translateY(-70vh);
  }

  to {
    transform: translateZ(-50em) translateY(0);
  }
}

@keyframes --moveup {

  0% {
    --z-index1: 4;
    --z-index2: 3;
    --z-index3: 2;
    --z-index4: 1;
    transform: translateY(35vh)
  }

  5%,
  25% {
    --z-index1: 3;
    --z-index2: 4;
    --z-index3: 2;
    --z-index4: 1;
    transform: translateY(15vh)
  }

  30%,
  50% {
    --z-index1: 1;
    --z-index2: 2;
    --z-index3: 4;
    --z-index4: 3;
    transform: translateY(-5vh);

  }

  55%,
  75% {
    --z-index1: 1;
    --z-index2: 2;
    --z-index3: 3;
    --z-index4: 4;
    transform: translateY(-25vh);

  }

  80%,
  95% {
    --z-index1: 1;
    --z-index2: 2;
    --z-index3: 3;
    --z-index4: 4;
    transform: translateY(-25vh);

  }

  100% {
    --z-index1: 1;
    --z-index2: 2;
    --z-index3: 3;
    --z-index4: 4;
    transform: translateY(-25vh);

  }

}

@keyframes --background {
  from {
    transform: translateZ(-50em);
  }

  to {
    transform: translateZ(-50em);
  }
}

@keyframes rotate {
  from {
    transform: rotateY(0deg);
  }

  to {
    transform: rotateY(360deg);
  }
}

.vertical-scroll:nth-child(2) .fake-scroller {
  scroll-timeline: --horizontal-scroll-1 inline;
}

.vertical-scroll:nth-child(3) .fake-scroller {
  scroll-timeline: --horizontal-scroll-2 inline;
}

.vertical-scroll:nth-child(4) .fake-scroller {
  scroll-timeline: --horizontal-scroll-3 inline;
}

.vertical-scroll:nth-child(5) .fake-scroller {
  scroll-timeline: --horizontal-scroll-3 inline;
}

.vertical-scroll:nth-of-type(1) {
  z-index: var(--z-index1);
}

.vertical-scroll:nth-of-type(2) {
  z-index: var(--z-index2);
}

.vertical-scroll:nth-of-type(3) {
  z-index: var(--z-index3);
}

.vertical-scroll:nth-of-type(4) {
  z-index: var(--z-index4);
}


.scene {
  position: fixed;
  width: 100dvw;
  height: 100dvh;
  transform-style: preserve-3d;
  perspective: 800px;

  ul {
    position: absolute;
    display: grid;
    inset: 0;
    background-color: #ff03;
    transform-style: preserve-3d;

    li {
      grid-area: 1/1;
      border: 5px solid black;
    }

    .vloer {
      background-color: aqua;
      width: 100dvw;
      height: 50vmin;
      align-self: end;
      transform-origin: bottom;
      rotate: x 90deg;
    }

    .linkermuur {
      background-color: aqua;
      width: 50vmin;
      height: 100dvh;
      justify-self: start;
      transform-origin: left;
      rotate: y 90deg;
    }

    .rechtermuur {
      background-color: aqua;
      width: 50vmin;
      height: 100dvh;
      justify-self: end;
      transform-origin: right;
      rotate: y -90deg;
    }

    .achtermuur {
      background-color: aqua;
      width: 100dvw;
      height: 100dvh;
      translate: 0 0 -50vmin;

    }

    .plafond {
      background-color: aqua;
      width: 100dvw;
      height: 50vmin;
      align-self: start;
      transform-origin: top;
      rotate: x -90deg;
    }
  }
}

@keyframes --achtermuur {
  from {
    translate: 0 0 -50vmin;
  }

  to {
    translate: 0 0 -10vmin;
  }
}